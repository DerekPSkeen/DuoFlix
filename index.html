<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DuoFlix ‚Ä¢ Watch Together</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<script src="https://cdn.tailwindcss.com"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
  body { font-family: 'Inter', system-ui; overflow:hidden; }
  .card { transition: transform 0.08s linear; box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.5); touch-action: none; }
  .overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:80px; font-weight:900; opacity:0; transition:opacity 0.2s; pointer-events:none; text-shadow:0 0 30px currentColor; }
  .like { color:#22c55e; }
  .nope { color:#ef4444; }
</style>
</head>
<body class="bg-zinc-950 text-white min-h-screen">

<div class="max-w-md mx-auto bg-zinc-900 min-h-screen">

  <!-- Header -->
  <div class="p-4 border-b border-zinc-800 flex items-center gap-3">
    <div class="text-4xl">‚ù§Ô∏è</div>
    <h1 class="text-4xl font-bold tracking-tighter">DuoFlix</h1>
  </div>

  <!-- Tabs -->
  <div class="flex border-b border-zinc-800 text-sm">
    <button onclick="showTab(0)" id="tab0" class="flex-1 py-4 font-semibold border-b-4 border-red-500 text-red-500">SWIPE</button>
    <button onclick="showTab(1)" id="tab1" class="flex-1 py-4 font-semibold text-zinc-400">MATCHES (<span id="matchCount">0</span>)</button>
    <button onclick="showTab(2)" id="tab2" class="flex-1 py-4 font-semibold text-zinc-400">PRO</button>
  </div>

  <!-- SWIPE SCREEN -->
  <div id="screen0" class="p-6 flex flex-col items-center relative">
    <div id="card-container" class="relative w-full max-w-[340px] h-[520px]">
      <div id="card" class="card bg-zinc-800 rounded-3xl overflow-hidden w-full h-full cursor-grab active:cursor-grabbing absolute"></div>
      <div id="like-overlay" class="overlay like">LIKE</div>
      <div id="nope-overlay" class="overlay nope">NOPE</div>
    </div>

    <!-- Backup buttons -->
    <div class="flex justify-center gap-12 mt-8">
      <button onclick="swipeLeft()" class="w-20 h-20 bg-zinc-800 rounded-3xl text-6xl flex items-center justify-center active:scale-90">‚ùå</button>
      <button onclick="swipeRight()" class="w-20 h-20 bg-red-600 rounded-3xl text-6xl flex items-center justify-center active:scale-90">‚ù§Ô∏è</button>
    </div>

    <button onclick="undoSwipe()" class="mt-6 text-sm text-zinc-400 underline">Undo last swipe</button>
  </div>

  <!-- MATCHES SCREEN -->
  <div id="screen1" class="p-6 hidden">
    <h2 class="text-center mb-6 text-xl">Your Matches</h2>
    <div id="match-list" class="grid grid-cols-2 gap-4"></div>
  </div>

  <!-- PRO SCREEN -->
  <div id="screen2" class="p-6 hidden text-center">
    <div class="text-6xl mb-6">üîì</div>
    <h2 class="text-3xl font-bold">Go Pro ‚Äî $4.99/mo per couple</h2>
    <p class="text-zinc-400 mt-2">Unlimited swipes ‚Ä¢ Live sync ‚Ä¢ No ads</p>
    <button onclick="upgradeToPro()" class="mt-12 bg-gradient-to-r from-red-500 to-pink-500 w-full py-5 rounded-3xl text-xl font-bold">Upgrade Now</button>
  </div>

</div>

<script>
// ====================== YOUR TMDB TOKEN ======================
const TMDB_READ_TOKEN = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJlMjA0ZGQzYTU5ZWY2MzY1MzRlOTBlZGE2ZDU4NWJlNCIsIm5iZiI6MTc3MTc3MjIxMy43NTEwMDAyLCJzdWIiOiI2OTliMTkzNWJkN2E3NTBhNDk4MGVkZTciLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.AkgenA40NIZJ4jfNEGVPnxAQxtE000b7fY3g3EgF5gY';

let shows = [];
let current = 0;
let lastSwiped = null;
let matches = JSON.parse(localStorage.getItem('duoflixMatches')) || [];

async function loadRealShows() {
  try {
    const res = await fetch('https://api.themoviedb.org/3/trending/all/week?language=en-US', {
      headers: { 'Authorization': `Bearer ${TMDB_READ_TOKEN}` }
    });
    const data = await res.json();
    shows = data.results.map(item => ({
      id: item.id,
      title: item.title || item.name,
      year: (item.release_date || item.first_air_date || '').slice(0,4),
      rating: item.vote_average.toFixed(1),
      genre: "Trending",
      img: `https://image.tmdb.org/t/p/w500${item.poster_path}`,
      desc: (item.overview || "Great show!").slice(0,80) + "...",
      providers: ["Netflix","Max","Hulu"],
      actors: getActors(item.title || item.name)
    }));
    current = 0;
    showCard();
  } catch(e) { console.log("Fallback"); }
}

function getActors(title) {
  const map = {
    "Dune": ["Timoth√©e Chalamet", "Zendaya", "Rebecca Ferguson"],
    "Oppenheimer": ["Cillian Murphy", "Emily Blunt", "Robert Downey Jr."],
    "House of the Dragon": ["Matt Smith", "Emma D'Arcy", "Olivia Cooke"],
    "Barbie": ["Margot Robbie", "Ryan Gosling", "America Ferrera"],
    "Furiosa": ["Anya Taylor-Joy", "Chris Hemsworth"]
  };
  for (let key in map) if (title.includes(key)) return map[key];
  return ["Top Cast", "Loading..."];
}

function showCard() {
  const show = shows[current] || {title:"Dune: Part Two",img:"https://picsum.photos/id/1015/600/800",info:"2024 ‚Ä¢ Sci-Fi ‚Ä¢ 8.7", actors:["Timoth√©e Chalamet", "Zendaya"]};
  document.getElementById('card').innerHTML = `
    <img src="${show.img}" style="width:100%;height:auto;max-height:280px;object-fit:cover;">
    <div style="padding:20px;text-align:center;background:#27272a;">
      <h2 style="font-size:26px;margin:0 0 6px 0;">${show.title}</h2>
      <p style="color:#a1a1aa;font-size:17px;">${show.year} ‚Ä¢ ${show.genre} ‚Ä¢ ${show.rating}</p>
      <p style="margin-top:12px;font-size:15px;color:#d1d5db;line-height:1.4;">${show.desc}</p>
      <div style="margin-top:16px;font-size:15px;color:#a1a1aa;">Starring: ${show.actors.join(", ")}</div>
    </div>
  `;
}

// ==================== PREMIUM DRAG SWIPE ====================
const card = document.getElementById('card');
let isDragging = false;
let startX = 0;
let currentTranslate = 0;
const likeOverlay = document.getElementById('like-overlay');
const nopeOverlay = document.getElementById('nope-overlay');

card.addEventListener('pointerdown', e => {
  isDragging = true;
  startX = e.clientX;
  card.style.transition = 'none';
});

document.addEventListener('pointermove', e => {
  if (!isDragging) return;
  currentTranslate = e.clientX - startX;
  const progress = Math.min(Math.abs(currentTranslate) / 120, 1);

  card.style.transform = `translateX(${currentTranslate}px) rotate(${currentTranslate / 18}deg) scale(${1 - progress * 0.06})`;

  if (currentTranslate > 0) {
    likeOverlay.style.opacity = progress;
    nopeOverlay.style.opacity = 0;
  } else {
    nopeOverlay.style.opacity = progress;
    likeOverlay.style.opacity = 0;
  }

  if (Math.abs(currentTranslate) > 110) {
    isDragging = false;
    if (currentTranslate > 0) {
      card.style.transition = 'transform 0.3s';
      card.style.transform = `translateX(600px) rotate(45deg) scale(0.75)`;
      setTimeout(() => nextCard(true), 280);
    } else {
      card.style.transition = 'transform 0.3s';
      card.style.transform = `translateX(-600px) rotate(-45deg) scale(0.75)`;
      setTimeout(() => nextCard(false), 280);
    }
  }
});

document.addEventListener('pointerup', e => {
  if (!isDragging) return;
  isDragging = false;
  card.style.transition = 'transform 0.4s cubic-bezier(0.25, 0.1, 0.25, 1)';

  if (Math.abs(currentTranslate) > 90) {
    if (currentTranslate > 0) {
      card.style.transform = `translateX(600px) rotate(45deg) scale(0.75)`;
      setTimeout(() => nextCard(true), 280);
    } else {
      card.style.transform = `translateX(-600px) rotate(-45deg) scale(0.75)`;
      setTimeout(() => nextCard(false), 280);
    }
  } else {
    card.style.transform = 'translateX(0) rotate(0deg) scale(1)';
    likeOverlay.style.opacity = 0;
    nopeOverlay.style.opacity = 0;
  }
});

function nextCard(isLike) {
  lastSwiped = shows[current];
  if (isLike) {
    yourLikes.push(shows[current]);
    if (partnerLikes.some(s => s.id === shows[current].id)) createMatch(shows[current]);
  }
  current = (current + 1) % shows.length;
  showCard();
  card.style.transition = 'none';
  card.style.transform = 'translateX(0) rotate(0deg) scale(1)';
  likeOverlay.style.opacity = 0;
  nopeOverlay.style.opacity = 0;
}

function swipeLeft() { nextCard(false); }
function swipeRight() { nextCard(true); }

function undoSwipe() {
  if (!lastSwiped) return alert("Nothing to undo yet");
  current = shows.findIndex(s => s.id === lastSwiped.id);
  if (current === -1) current = 0;
  showCard();
  lastSwiped = null;
}

function createMatch(show) {
  if (matches.some(m => m.id === show.id)) return;
  matches.push(show);
  localStorage.setItem('duoflixMatches', JSON.stringify(matches));
  document.getElementById('match-modal').classList.remove('hidden');
  document.getElementById('modal-poster').innerHTML = `<img src="${show.img}" class="w-full h-full object-cover">`;
  document.getElementById('modal-title').textContent = show.title;
  renderMatches();
}

function closeModal() {
  document.getElementById('match-modal').classList.add('hidden');
}

function showTab(n) {
  document.getElementById('screen0').style.display = n === 0 ? 'block' : 'none';
  document.getElementById('screen1').style.display = n === 1 ? 'block' : 'none';
  document.getElementById('screen2').style.display = n === 2 ? 'block' : 'none';
}

function upgradeToPro() {
  alert("DuoFlix Pro ‚Äì $4.99/month per couple\nUnlimited swipes for both of you ‚ù§Ô∏è");
}

let yourLikes = [];
let partnerLikes = [];

loadRealShows();
showCard();
</script>
</body>
</html>

