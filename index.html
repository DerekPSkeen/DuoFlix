<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DuoFlix ‚Ä¢ Watch Together</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
  body { font-family: 'Inter', system-ui; }
  .card { transition: transform 0.1s linear; box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.4); user-select: none; }
</style>
</head>
<body class="bg-zinc-950 text-white min-h-screen">

<div class="max-w-md mx-auto bg-zinc-900 min-h-screen">

  <!-- Header -->
  <div class="p-4 border-b border-zinc-800 flex items-center gap-3">
    <div class="text-4xl">‚ù§Ô∏è</div>
    <h1 class="text-4xl font-bold tracking-tighter">DuoFlix</h1>
  </div>

  <!-- Tabs -->
  <div class="flex border-b border-zinc-800 text-sm">
    <button onclick="showTab(0)" id="tab0" class="flex-1 py-4 font-semibold border-b-4 border-red-500 text-red-500">SWIPE</button>
    <button onclick="showTab(1)" id="tab1" class="flex-1 py-4 font-semibold text-zinc-400">MATCHES (<span id="matchCount">0</span>)</button>
    <button onclick="showTab(2)" id="tab2" class="flex-1 py-4 font-semibold text-zinc-400">PRO</button>
  </div>

  <!-- SWIPE SCREEN -->
  <div id="screen0" class="p-6 flex flex-col items-center">
    <div id="card" class="card bg-zinc-800 rounded-3xl overflow-hidden w-full max-w-[340px] cursor-grab active:cursor-grabbing"></div>

    <!-- Backup buttons -->
    <div class="flex justify-center gap-12 mt-8">
      <button onclick="swipeLeft()" class="w-20 h-20 bg-zinc-800 rounded-3xl text-6xl flex items-center justify-center">‚ùå</button>
      <button onclick="swipeRight()" class="w-20 h-20 bg-red-600 rounded-3xl text-6xl flex items-center justify-center">‚ù§Ô∏è</button>
    </div>
  </div>

  <!-- MATCHES SCREEN -->
  <div id="screen1" class="p-6 hidden">
    <h2 class="text-center mb-6 text-xl">Your Matches</h2>
    <div id="match-list" class="grid grid-cols-2 gap-4"></div>
  </div>

  <!-- PRO SCREEN -->
  <div id="screen2" class="p-6 hidden text-center">
    <div class="text-6xl mb-6">üîì</div>
    <h2 class="text-3xl font-bold">Go Pro ‚Äî $4.99/mo per couple</h2>
    <p class="text-zinc-400 mt-2">Unlimited swipes ‚Ä¢ Live sync ‚Ä¢ No ads</p>
    <button onclick="upgradeToPro()" class="mt-12 bg-gradient-to-r from-red-500 to-pink-500 w-full py-5 rounded-3xl text-xl font-bold">Upgrade Now</button>
  </div>

</div>

<script>
// ====================== YOUR TMDB TOKEN ======================
const TMDB_READ_TOKEN = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJlMjA0ZGQzYTU5ZWY2MzY1MzRlOTBlZGE2ZDU4NWJlNCIsIm5iZiI6MTc3MTc3MjIxMy43NTEwMDAyLCJzdWIiOiI2OTliMTkzNWJkN2E3NTBhNDk4MGVkZTciLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.AkgenA40NIZJ4jfNEGVPnxAQxtE000b7fY3g3EgF5gY';

let shows = [];
let current = 0;
let matches = JSON.parse(localStorage.getItem('duoflixMatches')) || [];

async function loadRealShows() {
  try {
    const res = await fetch('https://api.themoviedb.org/3/trending/all/week?language=en-US', {
      headers: { 'Authorization': `Bearer ${TMDB_READ_TOKEN}` }
    });
    const data = await res.json();
    shows = data.results.map(item => ({
      id: item.id,
      title: item.title || item.name,
      year: (item.release_date || item.first_air_date || '').slice(0,4),
      rating: item.vote_average.toFixed(1),
      genre: "Trending",
      img: `https://image.tmdb.org/t/p/w500${item.poster_path}`,
      desc: (item.overview || "Great show!").slice(0,80) + "...",
      providers: ["Netflix","Max","Hulu"]
    }));
    current = 0;
    showCard();
  } catch(e) { console.log("Fallback used"); }
}

function showCard() {
  const show = shows[current] || {title:"Dune: Part Two",img:"https://picsum.photos/id/1015/600/800",info:"2024 ‚Ä¢ Sci-Fi ‚Ä¢ 8.7"};
  document.getElementById('card').innerHTML = `
    <img src="${show.img}" style="width:100%;height:460px;object-fit:cover;">
    <div style="padding:24px;text-align:center;">
      <h2 style="font-size:28px;margin:0 0 8px 0;">${show.title}</h2>
      <p style="color:#a1a1aa;font-size:18px;">${show.info || show.year + " ‚Ä¢ " + show.genre + " ‚Ä¢ " + show.rating}</p>
    </div>
  `;
}

// ==================== DRAG SWIPE LOGIC ====================
let isDragging = false;
let startX = 0;
let currentX = 0;
const cardElement = document.getElementById('card');

cardElement.addEventListener('pointerdown', (e) => {
  isDragging = true;
  startX = e.clientX;
  cardElement.style.transition = 'none';
});

document.addEventListener('pointermove', (e) => {
  if (!isDragging) return;
  currentX = e.clientX - startX;
  cardElement.style.transform = `translateX(${currentX}px) rotate(${currentX / 15}deg)`;
});

document.addEventListener('pointerup', (e) => {
  if (!isDragging) return;
  isDragging = false;
  cardElement.style.transition = 'transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';

  if (currentX > 150) {
    cardElement.style.transform = `translateX(500px) rotate(30deg)`;
    setTimeout(() => { nextCard(); }, 300);
  } else if (currentX < -150) {
    cardElement.style.transform = `translateX(-500px) rotate(-30deg)`;
    setTimeout(() => { nextCard(); }, 300);
  } else {
    cardElement.style.transform = 'translateX(0) rotate(0deg)';
  }
});

function nextCard() {
  current = (current + 1) % shows.length;
  showCard();
  cardElement.style.transition = 'none';
  cardElement.style.transform = 'translateX(0) rotate(0deg)';
}

function swipeLeft() { nextCard(); }
function swipeRight() { nextCard(); }

function showTab(n) {
  document.getElementById('screen0').style.display = n === 0 ? 'block' : 'none';
  document.getElementById('screen1').style.display = n === 1 ? 'block' : 'none';
  document.getElementById('screen2').style.display = n === 2 ? 'block' : 'none';
}

function upgradeToPro() {
  alert("DuoFlix Pro ‚Äì $4.99/month per couple\nUnlimited swipes for both of you ‚ù§Ô∏è");
}

loadRealShows();
showCard();
</script>
</body>
</html>
